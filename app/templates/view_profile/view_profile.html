{% extends "const/base.html" %} {% block content %}
<style>
  .img-bio-section {
    display: grid;
    grid-template-columns: 1fr 2fr;
    gap: 30px;
    max-width: 1200px;
    margin: 60px auto;
    font-family: "Poppins", sans-serif;
  }

  .profile-sidebar {
    background-color: white;
    border-radius: 20px;
    padding: 30px;
    box-shadow: 0px 4px 12px rgba(0, 0, 0, 0.05);
    display: flex;
    flex-direction: column;
    align-items: center;
    gap: 20px;
  }

  .profile-image-wrapper {
    position: relative;
    width: 200px;
    height: 200px;
  }

  .profile-image {
    width: 100%;
    height: 100%;
    object-fit: cover;
    border-radius: 50%;
    z-index: 1;
    position: relative;
  }

  .profile-frame {
    position: absolute;
    top: -10px;
    left: -10px;
    right: -10px;
    bottom: -10px;
    border: 2px dashed rgb(68, 138, 115);
    border-radius: 50%;
    z-index: 0;
  }

  .username {
    font-size: 40px;
    font-weight: 500;
    color: black;
    text-align: center;
  }

  .one-liner {
    font-size: 16px;
    font-weight: 500;
    color: rgb(68, 68, 68);
    text-align: center;
  }

  .profile-main {
    display: flex;
    flex-direction: column;
    gap: 20px;
  }

  .intro-box {
    height: 340px;
    display: flex;
    flex-direction: column;
    justify-content: space-between;
  }
  .intro-box,
  .link-box {
    background-color: white;
    border-radius: 20px;
    padding: 30px;
    box-shadow: 0px 4px 12px rgba(0, 0, 0, 0.05);
  }

  .description-text {
    font-size: 32px;
    font-weight: 700;
    color: black;
    margin: 15px 0 25px;
  }

  .footer-btn {
    font-weight: 500;
    font-size: 16px;
    color: white;
    background-color: rgb(68, 138, 115);
    border: none;
    padding: 12px 28px;
    border-radius: 8px;
    text-decoration: none;
    transition: background-color 0.3s ease;
    width: 182px;
  }

  .footer-btn:hover {
    background-color: black;
    color: white;
  }

  .link-box {
    display: flex;
    justify-content: space-around;
    align-items: center;
    flex-wrap: wrap;
    gap: 20px;
  }

  .link-btn {
    display: flex;
    align-items: center;
    gap: 10px;
    font-weight: 500;
    font-size: 16px;
    color: black;
    padding: 12px 20px;
    border-radius: 8px;
    border: 2px solid;
    background-color: transparent;
    text-decoration: none;
    transition: background-color 0.3s ease, color 0.3s ease,
      border-color 0.3s ease;
  }

  .link-btn i {
    font-size: 18px;
  }

  /* Specific color themes */
  .link-btn.mail {
    border-color: rgb(68, 138, 115);
    color: rgb(68, 138, 115);
  }
  .link-btn.mail:hover {
    background-color: rgb(68, 138, 115);
    color: white;
  }

  .link-btn.linkedin {
    border-color: #0077b5;
    color: #0077b5;
  }
  .link-btn.linkedin:hover {
    background-color: #0077b5;
    color: white;
  }

  .link-btn.github {
    border-color: #6e40c9;
    color: #6e40c9;
  }
  .link-btn.github:hover {
    background-color: #6e40c9;
    color: white;
  }

  .scroll-box {
    background-color: white;
    border-radius: 20px;
    padding: 30px;
    box-shadow: 0px 4px 12px rgba(0, 0, 0, 0.05);
    max-height: 400px;
    overflow-y: auto;
  }

  .section-title {
    font-family: "Poppins", sans-serif;
    font-size: 22px;
    font-weight: 500;
    color: black;
    margin-bottom: 20px;
  }

  .entry-block {
    margin-bottom: 15px;
  }

  .entry-date {
    font-family: "Poppins", sans-serif;
    font-size: 16px;
    font-weight: 400;
    color: rgb(68, 68, 68);
  }

  .entry-org {
    font-family: "Poppins", sans-serif;
    font-size: 20px;
    font-weight: 500;
    color: rgb(68, 68, 68);
    line-height: 52px;
  }

  .entry-role {
    font-family: "Poppins", sans-serif;
    font-size: 16px;
    font-weight: 400;
    color: rgb(68, 68, 68);
  }

  .entry-divider {
    border: none;
    border-top: 1px solid rgb(162, 162, 162);
    margin: 25px 0 15px 0;
  }

  .experience-education-section {
    display: grid;
    grid-template-columns: 1fr 1fr;
    gap: 30px;
    max-width: 1200px;
    margin: 30px auto 60px;
  }

  .entry-content {
    display: flex;
    align-items: flex-start;
    gap: 15px;
  }

  .entry-icon {
    min-width: 36px;
    min-height: 36px;
    border-radius: 8px;
    background-color: rgb(226, 226, 226, 0.3);
    display: flex;
    justify-content: center;
    align-items: center;
    margin-top: 4px;
  }

  .entry-icon i {
    color: rgb(68, 138, 115);
    font-size: 16px;
  }

  .projects-section {
    background-color: white;
    border-radius: 20px;
    padding: 30px;
    box-shadow: 0px 4px 12px rgba(0, 0, 0, 0.05);
    margin-top: 30px;
  }

  .projects-section .section-title {
    font-family: "Poppins", sans-serif;
    font-size: 22px;
    font-weight: 500;
    color: black;
    margin-bottom: 20px;
  }

  .projects-section .entry-block {
    margin-bottom: 15px;
  }

  .projects-section .entry-content {
    display: flex;
    align-items: flex-start;
    gap: 15px;
  }

  .projects-section .entry-icon {
    min-width: 20px;
    min-height: 20px;
    border-radius: 50%;
    display: flex;
    justify-content: center;
    align-items: center;
    margin-top: 6px;
    color: rgb(68, 138, 115);
  }

  .projects-section .entry-icon i {
    font-size: 10px;
  }

  .projects-section a {
    text-decoration: none;
    color: rgb(68, 68, 68);
    transition: color 0.2s ease;
  }

  .projects-section a:hover {
    color: rgb(68, 138, 115);
  }

  .projects-section .entry-divider {
    border: none;
    border-top: 1px solid rgb(162, 162, 162);
    margin: 20px 0 15px;
  }

  .languages-section {
    width: 100%;
    text-align: left;
  }

  .languages-title {
    font-family: "Poppins", sans-serif;
    font-size: 18px;
    font-weight: 500;
    color: black;
    margin-bottom: 10px;
  }

  .languages-list {
    display: flex;
    flex-wrap: wrap;
    gap: 10px;
  }

  .language-pill {
    background-color: rgba(68, 138, 115, 0.1);
    color: rgb(68, 138, 115);
    font-weight: 500;
    font-size: 14px;
    padding: 6px 12px;
    border-radius: 20px;
    white-space: nowrap;
  }

  .skills-section {
    background-color: white;
    border-radius: 20px;
    padding: 30px;
    box-shadow: 0px 4px 12px rgba(0, 0, 0, 0.05);
    margin: 30px auto;
    max-width: 1200px;
  }

  .skills-list {
    display: flex;
    flex-wrap: wrap;
    gap: 30px;
  }

  .skill-button {
    background-color: transparent;
    border: 2px solid rgb(68, 138, 115);
    color: rgb(68, 138, 115);
    font-size: 16px;
    font-weight: 500;
    padding: 10px 22px;
    border-radius: 12px;
    transition: all 0.3s ease;
    cursor: pointer;
  }

  .skill-button:hover {
    background-color: rgb(68, 138, 115);
    color: white;
  }

  /* ENDORSED version: default looks like hover */
  .skill-button.endorsed {
    background-color: rgb(68, 138, 115);
    color: white;
  }

  /* When hovered, go back to normal look */
  .skill-button.endorsed:hover {
    background-color: transparent;
    color: rgb(68, 138, 115);
  }

  .skill-button-wrapper {
    position: relative;
    display: inline-block;
    margin: 8px;
  }

  .endorsement-badge {
    position: absolute;
    top: 50%;
    transform: translateY(-50%);
    left: 100%; /* Stick it to the right side */
    margin-left: -6px; /* Slight overlap with the main button */
    background-color: white;
    color: rgb(68, 138, 115);
    border: 2px solid rgb(68, 138, 115);
    padding: 4px 10px;
    font-size: 13px;
    font-weight: 600;
    border-radius: 12px;
    z-index: 1;
    box-shadow: 0 0 0 2px white; /* Creates a clean break from the button */
  }

  /* If button is endorsed, match badge background */
  .skill-button.endorsed + .endorsement-badge {
    background-color: rgb(68, 138, 115);
    color: white;
    border-color: rgb(68, 138, 115);
    box-shadow: 0 0 0 2px rgb(68, 138, 115);
  }

  .empty-state {
    text-align: center;
    padding: 40px 20px;
    color: #333;
    font-family: "Poppins", sans-serif;
  }

  .empty-state i {
    font-size: 48px;
    color: rgb(68, 138, 115); /* Green shade */
    margin-bottom: 15px;
  }

  .empty-state p {
    font-size: 16px;
    font-weight: 500;
    color: #555;
  }

  @media (max-width: 768px) {
    .img-bio-section {
      grid-template-columns: 1fr;
    }

    .experience-education-section {
      grid-template-columns: 1fr;
    }

    .description-text {
      font-size: 28px;
    }

    .link-box {
      flex-direction: column;
    }
  }
</style>

<div class="img-bio-section">
  <!-- LEFT PANEL -->
  <div class="profile-sidebar">
    <div class="profile-image-wrapper">
      <img
        src="{{ url_for('static', filename='profile_photos/' ~ (profile.photo if profile.photo else 'default.png')) }}"
        alt="{{ profile.photo if profile.photo else 'Default Profile' }}"
        class="profile-image"
      />

      <div class="profile-frame"></div>
    </div>
    <div class="username">{{ user.username }}</div>
    <div class="one-liner">{{ profile.one_liner }}</div>
    <div class="languages-section">
      <div class="languages-title">Languages</div>
      <div class="languages-list">
        {% if languages %} {% for language in languages %}
        <span class="language-pill">{{ language.language.language }}</span>
        {% endfor %} {% else %}
        <div
          class="empty-state"
          style="margin-top: -20px; margin-bottom: -20px"
        >
          <p style="margin: -24px">The user hasn’t added any languages yet.</p>
        </div>
        {% endif %}
      </div>
    </div>
  </div>

  <!-- RIGHT PANEL -->
  <div class="profile-main">
    <!-- INTRO BOX -->
    <div class="intro-box">
      {% if profile.bio %}
      <div class="description-text">{{ profile.bio }}</div>
      {% else %}
      <div class="empty-state">
        <i class="fas fa-user-minus"></i>
        <p>The user hasn’t added their bio yet.</p>
      </div>
      {% endif %}
      <a
        href="{{ url_for('view_profile.download_cv', user_id=user.id) }}"
        class="footer-btn"
        >Download CV <i class="fa-solid fa-arrow-down"></i
      ></a>
    </div>

    <!-- LINKS BOX -->
    <div class="link-box">
      <a href="mailto:{{ user.email }}" class="link-btn mail">
        <i class="fas fa-envelope"></i> {{ user.email }}
      </a>
      <a
        href="{{ profile.linkedin_url }}"
        class="link-btn linkedin"
        target="_blank"
      >
        <i class="fab fa-linkedin"></i> LinkedIn
      </a>
      <a
        href="{{ profile.github_url }}"
        class="link-btn github"
        target="_blank"
      >
        <i class="fab fa-github"></i> GitHub
      </a>
    </div>
  </div>
</div>

<!-- SKILLS SECTION -->
<div class="skills-section">
  <div class="section-title">Skills</div>
  {% if skills %}
  <div class="skills-list">
    {% for skill in skills %} {% set endorsed = skill.skill.skill.lower() ==
    endorsed_skill.lower() %}
    <div class="skill-button-wrapper">
      <form
        method="post"
        action="{{ url_for(
              'view_profile.remove_endorsement' if endorsed else 'view_profile.endorse_skill',
              user_id=user.id,
              skill_id=skill.skill.id
            ) }}"
      >
        <button
          type="submit"
          class="skill-button {% if endorsed %}endorsed{% endif %}"
        >
          {{ skill.skill.skill }}
        </button>
      </form>
      {% if endorsement_counter[skill.skill.skill] > 0 %}
      <div class="endorsement-badge">
        {{ endorsement_counter[skill.skill.skill] }}
      </div>
      {% endif %}
    </div>
    {% endfor %}
  </div>
  {% else %}
  <div class="empty-state">
    <i class="fas fa-tools"></i>
    <p>The user hasn’t added any skills yet.</p>
  </div>
  {% endif %}
</div>

<!-- EXPERIENCE & EDUCATION SECTION -->
<div class="experience-education-section">
  <div class="scroll-box">
    <div class="section-title">Experience</div>

    {% if experiences %} {% for experience in experiences %}
    <div class="entry-block">
      <div class="entry-content">
        <div class="entry-icon">
          <i class="fas fa-briefcase"></i>
        </div>
        <div>
          <div class="entry-date">
            {{ experience.start_date }} - {{ experience.end_date }}
          </div>
          <div class="entry-org">{{ experience.organization_name }}</div>
          <div class="entry-role">{{ experience.position }}</div>
        </div>
      </div>
      {% if not loop.last %}
      <hr class="entry-divider" />
      {% endif %}
    </div>
    {% endfor %} {% else %}
    <div class="empty-state">
      <i class="fas fa-user-clock"></i>
      <p>The user hasn’t added any experiences yet.</p>
    </div>
    {% endif %}
  </div>

  <div class="scroll-box">
    <div class="section-title">Education</div>

    {% if educations %} {% for edu in educations %}
    <div class="entry-block">
      <div class="entry-content">
        <div class="entry-icon">
          <i class="fas fa-book"></i>
        </div>
        <div>
          <div class="entry-date">
            {{ edu.start_year }} - {{ edu.end_year }}
          </div>
          <div class="entry-org">{{ edu.institution_name }}</div>
          <div class="entry-role">{{ edu.course_name }}</div>
        </div>
      </div>
      {% if not loop.last %}
      <hr class="entry-divider" />
      {% endif %}
    </div>
    {% endfor %} {% else %}
    <div class="empty-state">
      <i class="fas fa-graduation-cap"></i>
      <p>The user hasn’t added any education details yet.</p>
    </div>
    {% endif %}
  </div>
</div>

<!-- PROJECTS SECTION -->
<div
  class="projects-section scroll-box"
  style="max-width: 1200px; margin: 0 auto 60px"
>
  <div class="section-title">Projects</div>

  {% if projects %} {% for project in projects %}
  <div class="entry-block">
    <div class="entry-content">
      <div class="entry-icon">
        <i class="fas fa-circle"></i>
      </div>
      <div>
        <a
          href="{{ project.link }}"
          target="_blank"
          style="text-decoration: none; color: rgb(68, 68, 68)"
        >
          <span
            style="
              font-family: 'Poppins', sans-serif;
              font-weight: 500;
              font-size: 20px;
            "
          >
            {{ project.title }}
            <i
              class="fas fa-arrow-up-right-from-square"
              style="font-size: 14px; margin-left: 6px"
            ></i>
          </span>
        </a>
        <div
          style="
            font-family: 'Poppins', sans-serif;
            font-weight: 400;
            font-size: 16px;
            color: rgb(68, 68, 68);
            margin-top: 8px;
          "
        >
          {{ project.description }}
        </div>
      </div>
    </div>
    {% if not loop.last %}
    <hr class="entry-divider" />
    {% endif %}
  </div>
  {% endfor %} {% else %}
  <div class="empty-state">
    <i class="fas fa-lightbulb"></i>
    <p>The user hasn’t added any projects yet.</p>
  </div>
  {% endif %}
</div>

{% endblock %}
